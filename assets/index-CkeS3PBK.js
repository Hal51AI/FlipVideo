var B=Object.defineProperty;var P=(r,e,t)=>e in r?B(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>(P(r,typeof e!="symbol"?e+"":e,t),t),N=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var s=(r,e,t)=>(N(r,e,"read from private field"),t?t.call(r):e.get(r)),u=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},D=(r,e,t,o)=>(N(r,e,"write to private field"),o?o.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const f of i.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var a;(function(r){r.LOAD="LOAD",r.EXEC="EXEC",r.WRITE_FILE="WRITE_FILE",r.READ_FILE="READ_FILE",r.DELETE_FILE="DELETE_FILE",r.RENAME="RENAME",r.CREATE_DIR="CREATE_DIR",r.LIST_DIR="LIST_DIR",r.DELETE_DIR="DELETE_DIR",r.ERROR="ERROR",r.DOWNLOAD="DOWNLOAD",r.PROGRESS="PROGRESS",r.LOG="LOG",r.MOUNT="MOUNT",r.UNMOUNT="UNMOUNT"})(a||(a={}));const v=(()=>{let r=0;return()=>r++})(),S=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),k=new Error("called FFmpeg.terminate()");var l,h,E,p,m,y,d;class M{constructor(){u(this,l,null);u(this,h,{});u(this,E,{});u(this,p,[]);u(this,m,[]);c(this,"loaded",!1);u(this,y,()=>{s(this,l)&&(s(this,l).onmessage=({data:{id:e,type:t,data:o}})=>{switch(t){case a.LOAD:this.loaded=!0,s(this,h)[e](o);break;case a.MOUNT:case a.UNMOUNT:case a.EXEC:case a.WRITE_FILE:case a.READ_FILE:case a.DELETE_FILE:case a.RENAME:case a.CREATE_DIR:case a.LIST_DIR:case a.DELETE_DIR:s(this,h)[e](o);break;case a.LOG:s(this,p).forEach(n=>n(o));break;case a.PROGRESS:s(this,m).forEach(n=>n(o));break;case a.ERROR:s(this,E)[e](o);break}delete s(this,h)[e],delete s(this,E)[e]})});u(this,d,({type:e,data:t},o=[],n)=>s(this,l)?new Promise((i,f)=>{const R=v();s(this,l)&&s(this,l).postMessage({id:R,type:e,data:t},o),s(this,h)[R]=i,s(this,E)[R]=f,n==null||n.addEventListener("abort",()=>{f(new DOMException(`Message # ${R} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(S));c(this,"load",({classWorkerURL:e,...t}={},{signal:o}={})=>(s(this,l)||(D(this,l,e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-lPYB70QI.js",import.meta.url),{type:"module"})),s(this,y).call(this)),s(this,d).call(this,{type:a.LOAD,data:t},void 0,o)));c(this,"exec",(e,t=-1,{signal:o}={})=>s(this,d).call(this,{type:a.EXEC,data:{args:e,timeout:t}},void 0,o));c(this,"terminate",()=>{const e=Object.keys(s(this,E));for(const t of e)s(this,E)[t](k),delete s(this,E)[t],delete s(this,h)[t];s(this,l)&&(s(this,l).terminate(),D(this,l,null),this.loaded=!1)});c(this,"writeFile",(e,t,{signal:o}={})=>{const n=[];return t instanceof Uint8Array&&n.push(t.buffer),s(this,d).call(this,{type:a.WRITE_FILE,data:{path:e,data:t}},n,o)});c(this,"mount",(e,t,o)=>{const n=[];return s(this,d).call(this,{type:a.MOUNT,data:{fsType:e,options:t,mountPoint:o}},n)});c(this,"unmount",e=>{const t=[];return s(this,d).call(this,{type:a.UNMOUNT,data:{mountPoint:e}},t)});c(this,"readFile",(e,t="binary",{signal:o}={})=>s(this,d).call(this,{type:a.READ_FILE,data:{path:e,encoding:t}},void 0,o));c(this,"deleteFile",(e,{signal:t}={})=>s(this,d).call(this,{type:a.DELETE_FILE,data:{path:e}},void 0,t));c(this,"rename",(e,t,{signal:o}={})=>s(this,d).call(this,{type:a.RENAME,data:{oldPath:e,newPath:t}},void 0,o));c(this,"createDir",(e,{signal:t}={})=>s(this,d).call(this,{type:a.CREATE_DIR,data:{path:e}},void 0,t));c(this,"listDir",(e,{signal:t}={})=>s(this,d).call(this,{type:a.LIST_DIR,data:{path:e}},void 0,t));c(this,"deleteDir",(e,{signal:t}={})=>s(this,d).call(this,{type:a.DELETE_DIR,data:{path:e}},void 0,t))}on(e,t){e==="log"?s(this,p).push(t):e==="progress"&&s(this,m).push(t)}off(e,t){e==="log"?D(this,p,s(this,p).filter(o=>o!==t)):e==="progress"&&D(this,m,s(this,m).filter(o=>o!==t))}}l=new WeakMap,h=new WeakMap,E=new WeakMap,p=new WeakMap,m=new WeakMap,y=new WeakMap,d=new WeakMap;const W=new Error("failed to get response body reader"),j=new Error("failed to complete download"),x="Content-Length",G=r=>new Promise((e,t)=>{const o=new FileReader;o.onload=()=>{const{result:n}=o;n instanceof ArrayBuffer?e(new Uint8Array(n)):e(new Uint8Array)},o.onerror=n=>{var i,f;t(Error(`File could not be read! Code=${((f=(i=n==null?void 0:n.target)==null?void 0:i.error)==null?void 0:f.code)||-1}`))},o.readAsArrayBuffer(r)}),F=async r=>{let e;if(typeof r=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(r)?e=atob(r.split(",")[1]).split("").map(t=>t.charCodeAt(0)):e=await(await fetch(r)).arrayBuffer();else if(r instanceof URL)e=await(await fetch(r)).arrayBuffer();else if(r instanceof File||r instanceof Blob)e=await G(r);else return new Uint8Array;return new Uint8Array(e)},H=async(r,e)=>{var n;const t=await fetch(r);let o;try{const i=parseInt(t.headers.get(x)||"-1"),f=(n=t.body)==null?void 0:n.getReader();if(!f)throw W;const R=[];let O=0;for(;;){const{done:w,value:A}=await f.read(),g=A?A.length:0;if(w){if(i!=-1&&i!==O)throw j;e&&e({url:r,total:i,received:O,delta:g,done:w});break}R.push(A),O+=g,e&&e({url:r,total:i,received:O,delta:g,done:w})}const b=new Uint8Array(O);let U=0;for(const w of R)b.set(w,U),U+=w.length;o=b.buffer}catch(i){console.log("failed to send download progress event: ",i),o=await t.arrayBuffer()}return o},_=async(r,e,t=!1,o)=>{const n=t?await H(r,o):await(await fetch(r)).arrayBuffer(),i=new Blob([n],{type:e});return URL.createObjectURL(i)},L=new M,C=document.getElementById("videoInput"),I=document.getElementById("videoOutput"),T=document.getElementById("message");async function X(){const r=C.files[0],{name:e}=r;await L.load({coreURL:await _("ffmpeg-core.js","text/javascript"),wasmURL:await _("ffmpeg-core.wasm","application/wasm"),workerURL:await _("ffmpeg-core.worker.js","text/javascript")}),L.writeFile(e,await F(r)),await L.exec(["-i",e,"-vf","hflip","-c:a","copy","output.mp4"]);const t=await L.readFile("output.mp4");I.style.display="block",I.src=URL.createObjectURL(new Blob([t.buffer],{type:"video/mp4"})),I.load();const o=document.createElement("a");o.classList.add("download-link"),o.textContent="Download Video",o.download=e,o.href=I.src,document.body.appendChild(o)}L.on("log",({message:r})=>{console.log(r)});L.on("progress",({progress:r,time:e})=>{const t=(r*100).toFixed(2),o=(e/1e6).toFixed(2);T.innerHTML=`Progress: ${t}%, Time: ${o}s`,Math.round(t)===100&&(T.innerHTML="Complete! Please Wait a Moment for Video to Load!")});C.addEventListener("change",X);
